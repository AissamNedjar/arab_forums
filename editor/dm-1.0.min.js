/************************************************#
* DM System for web services
* http://dm.duhoktimes.com/
*
* DM Library v1.01
* Work with JQuery Library 1.7.1 and later versions
* Copyright 2011 - 2012, Dilovan Matini
*
* Date: Wednesday, â€ژDecember â€ژ29, â€ژ2011
#************************************************/
var DMFolderPath='editor/'; // The folder path of the DM Library files.
var DM={version:"1.01",path:DMFolderPath,type:function(a){return $.type(a)},parseInt:function(a){return parseInt(a)||0},parseFloat:function(a){return parseFloat(a)||0},getElement:function(a,b){if(b){return $(a,b)[0]||false}else{return $(a)[0]||false}},getSelectedValue:function(a){return $(a).val()},goToURL:function(a){document.location=a},choose:function(d,a,b){var c=["s","c"];if($T(b)=="undefined"||!c.inArray(b)){b="s"}return(d==a?(b=="s"?" selected":" checked"):"")},round:function(e,f){if(!f||f==0){f=1}var d,a,c,g,b;d=Math.pow(10,f);a=Math.ceil(e*d)/d;c=Math.floor(e*d)/d;d=Math.pow(10,f+1);g=d*(a-e);b=d*(e-c)+(e<0?-1:1);return(g>=b?c:a)},rand:function(a){if($T(a)!="number"){a=999999}return Math.floor(Math.random()*a)},container:{id:0,obj:{},box:false,table:false,header:false,body:false,footer:false,buttons:{},align:"",disalign:"",defaults:{dir:"rtl",body:"",footer:"",error:false,padding:"25px",buttons:[]},setDefaults:function(d){var b=this,a=b.defaults,c=function(e,g,f){if(!f){f="string"}return(($T(e)!==f||f=="string"&&e=="")?g:e)};if(!d){d={}}d.parent=c(d.parent,document.body,"object");d.dir=c(d.dir,a.dir);d.body=c(d.body,a.body);d.footer=c(d.footer,a.footer);d.error=c(d.error,a.error,"boolean");d.padding=c(d.padding,a.padding);d.buttons=c(d.buttons,a.buttons,"array");b.obj=d;b.align=(d.dir=="rtl"?"right":"left");b.disalign=(d.dir=="rtl"?"left":"right");return d},create:function(){var a=this,b=DM.getElement,c=0;if(a.id==0){a.id=c=DM.rand();$(a.obj.parent).append('<div id="container'+c+'" class="DMContainer"><table id="table'+c+'" cellpadding="0" cellspacing="1" dir="'+a.obj.dir+'"><tr id="bodyRow'+c+'"><td id="body'+c+'" class="body"></td></tr></table></div>');$(a.obj.parent).append('<span id="highlight'+c+'" style="position:absolute;visibility:hidden;top:2px;left:2px;margin:0;padding:0;z-index:1000;background-color:#000;opacity:.50;filter:alpha(opacity=50);"></span>');a.box=b("#container"+c);$(a.box).hide();a.table=b("#table"+c);a.body=b("#body"+c);$(window).resize(function(){a.dimension()});$(window).scroll(function(){a.dimension()})}},open:function(c){var a=this,b=DM.getDocumentSize;c=a.setDefaults(c);a.reset();a.create();if($T(c.header)!=="undefined"){a.setHeader(c.header)}$(a.body).html((c.body.toLowerCase().indexOf("nobr")>=0)?c.body:"<nobr>"+c.body+"</nobr>");if(c.footer!=""||c.buttons.length>0){a.setFooter(c.footer,c.buttons)}if(c.error===true){$("#highlight"+a.id).css({top:"0",left:"0",width:b("width")+"px",height:b("height")+"px",visibility:"visible"});$(a.body).css({color:"#ff0000"})}$(a.body).css({padding:c.padding});$(a.box).show();a.dimension()},setHeader:function(d){var a=this;var c=a.table.insertRow(0);var b=c.insertCell(0);b.className="header";$(b).html('<div class="text"><nobr>&nbsp;'+d+'</nobr></div><img src="'+DM.path+'assets/close.gif" onclick="DM.container.close();" class="close" style="margin-'+a.align+':20px;">');a.header=b},setFooter:function(j,i){var a=this;var f=a.table.insertRow(a.table.rows.length==1?1:2);var k=f.insertCell(0);k.className="footer";var h="",g=[],e=[],b=["light","dark"],l,c;if(i.length>0){for(var d=0;d<i.length;d++){if($T(i[d].value)!=="string"||i[d].value==""){continue}c=($T(i[d].color)==="string"||b.inArray(i[d].color))?i[d].color:"light";h+='<input type="button" class="'+c+'" id="button'+a.id+d+'" value="'+i[d].value+'">';e[e.length]={id:"button"+a.id+d,name:i[d].name||"",disabled:i[d].disabled||false,hide:i[d].hide||false,click:i[d].click||function(){}}}}$(k).html('<table width="100%" cellpadding="0" cellspacing="0"><tr><td class="text"><nobr>'+j+'</nobr></td><td class="buttons" align="'+a.disalign+'" style="margin-'+a.align+':20px;"><nobr>'+h+"</nobr></td></tr></table>");for(var d=0;d<e.length;d++){l=$I("#"+e[d].id);$(l).click(e[d].click);l.disabled=e[d].disabled;if(l.disabled===true){l.className="light"}if(e[d].hide===true){$(l).hide()}if(e[d].name!=""){a.buttons[e[d].name]=l}}a.footer=k},dimension:function(){var w,h,x,y,ie6=($.browser.msie&&$.browser.version>=6&&$.browser.version<7?true:false),align=(ie6?"right":"left");w=this.table.offsetWidth;h=this.table.offsetHeight;x=Math.ceil(($(window).width()-w)/2)+(ie6?0:$(window).scrollLeft());y=Math.ceil(($(window).height()-h)/2)+$(window).scrollTop();var position={top:y+"px",width:w+"px",height:h+"px"};eval("position."+align+' = "'+x+'px";');$(this.box).css(position)},reset:function(){var b=this;if(b.id>0){var a=0,c="bodyRow"+b.id;while(b.table.rows.length>1){if(b.table.rows[a].id!=c){b.table.deleteRow(a)}else{a++}}$("#highlight"+b.id).css({top:"2px",left:"2px",width:"2px",height:"2px",visibility:"hidden"});$(b.body).css({color:"#000"});$(b.body).html("")}},close:function(){var a=this;if(a.id>0){$(a.box).hide();a.reset()}}},getDocumentSize:function(e,f){var a=0;if(!f){f=window.document}var c={width:function(){var g=self.innerWidth;if(f.compatMode||$.browser.msie){g=(f.compatMode=="CSS1Compat")?f.documentElement.clientWidth:f.body.clientWidth}return g},height:function(){var g=self.innerHeight;if(f.compatMode||$.browser.msie){g=(f.compatMode=="CSS1Compat")?f.documentElement.clientHeight:f.body.clientHeight}return g}};if(e=="width"){var d=(f.compatMode!="CSS1Compat")?f.body.scrollWidth:f.documentElement.scrollWidth;a=Math.max(d,c.width())}if(e=="height"){var b=(f.compatMode!="CSS1Compat")?f.body.scrollHeight:f.documentElement.scrollHeight;a=Math.max(b,c.height())}return a},extend:function(d,c,b){if($T(d)=="object"&&$T(c)=="object"){b=(b===false)?false:true;for(var a in c){if(b||$T(d[a])!="undefined"){if($T(c[a])=="object"){this.extend(d[a],c[a])}else{d[a]=c[a]}}}}},colorPicker:{name:"",tempName:"DMColor",panels:[],panel:function(a,d){var c=this;if($T(a)!="string"||a==""){a=c.tempName}c.name=a;c.rand=DM.rand();c.panels[a]={rand:c.rand,color:"#ffffff",click:function(){}};if(d){var b=true;if($T(d.color)=="string"&&(/^#([a-fA-F0-9]{6})$/).test(d.color)){c.panels[a].color=d.color;b=false}if($T(d.click)=="function"){c.panels[a].click=d.click}if(b&&$T(d.blank)=="boolean"&&d.blank==true){c.panels[a].color=""}}return c.create()},create:function(){var h=this,j="",g=h.name,d=h.panels[g].color,b=[[],[],[],[],[],[]],k=["00","33","66","99","cc","ff"],f=["0033","0066","0099","00cc","00ff","33ff","66ff","99ff","ccff","ffff","ffcc","ff99","ff66","ff33","ff00","cc00","9900","6600","3300","0000",["000000","333333","666666","999999","cccccc","eeeeee"],["222222","555555","888888","bbbbbb","dddddd","ffffff"]];for(var e=0;e<f.length;e++){for(var a=0;a<k.length;a++){b[a][e]=($T(f[e])=="array"?f[e][a]:k[a]+f[e]+"")}}j+='<table height="55" cellpadding="0" cellspacing="2"><tr><td style="border:#c0c0c0 1px solid;padding:4px;"><table width="43" height="43" cellpadding="2" cellspacing="0"><tr><td id="colorPreview'+g+h.rand+'" class="DMColorPickerPreview" style="color:'+h.codeColor(d)+";background-color:"+d+';" dir="ltr">'+d+'</td></tr></table></td><td><table width="220" cellpadding="0" cellspacing="1" bgcolor="#000000">';$.each(b,function(l,c){j+="<tr>";$.each(c,function(n,m){j+='<td width="8" height="8" onclick="DM.colorPicker.click(this);" style="cursor:pointer;background-color:#'+m+'" panel="'+g+'"></td>'});j+="</tr>"});j+="</table></td></tr></table>";return j},getColor:function(a){if($T(a)!="string"||a==""){a=this.tempName}return this.panels[a].color},click:function(e){var a=this,b=a.rgb2hex($(e).css("background-color")),d=$(e).attr("panel"),c=a.panels[d].rand;$("#colorPreview"+d+c).css({"background-color":b,color:a.codeColor(b)});$("#colorPreview"+d+c).html("<nobr>"+b+"</nobr>");a.panels[d].color=b;a.panels[d].click()},codeColor:function(c){var b=parseInt(c.substr(1,1)),a=parseInt(c.substr(3,1));return(isNaN(b)||isNaN(a)?"#000":"#fff")},rgb2hex:function(a){a=a.replace(/\s/igm,"").toLowerCase();if(a.indexOf("rgb(")>=0){a=a.replace(/^rgb\((\d*),(\d*),(\d*)\)$/igm,function(e,c,h,f){var d=function(g){var b=(parseInt(g).toString(16));if(b.length==1){b=("0"+b)}return b.toLowerCase()};return"#"+d(c)+d(h)+d(f)})}return a}},isAncestor:function(a,c){var b=false;if(a&&c){if(a===c){b=true}else{if(a.nodeType&&c.nodeType){if(a.contains){b=a.contains(c)}else{if(a.compareDocumentPosition){b=!!(a.compareDocumentPosition(c)&16)}}}}}return b}};String.prototype.trim=function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")};String.prototype.ltrim=function(){return this.replace(/^\s+/,"")};String.prototype.rtrim=function(){return this.replace(/\s+$/,"")};Array.prototype.add=function(){var c=arguments;if(typeof c=="object"){for(var b=0;b<c.length;b++){this.push(c[b])}}};Array.prototype.clear=function(){this.splice(0,this.length)};Array.prototype.trash=function(a){var b=this.getIndex(a);if(b>=0){this.splice(b,1)}};Array.prototype.inArray=function(a){for(var b=0;b<this.length;b++){if(this[b]==a){return true}}return false};Array.prototype.getIndex=function(a){for(var b=0;b<this.length;b++){if(this[b]==a){return b}}return -1};Array.prototype.merge=function(){var c=arguments;for(var b=0;b<c.length;b++){if(typeof c[b]=="object"){for(var d=0;d<c[b].length;d++){this.add(c[b][d])}}}};var $I=DM.getElement,$S=DM.getSelectedValue,$T=DM.type,$G=DM.goToURL,$PI=DM.parseInt,$PF=DM.parseFloat;