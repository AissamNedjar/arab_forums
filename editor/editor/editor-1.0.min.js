/************************************************#
* DM System for web services
* http://dm.duhoktimes.com/
*
* DM Editor v1.01
* Work with below libraries
* 1- JQuery Library 1.7.1 and later versions
* 2- DM Library 1.0 and later versions
* Copyright 2011 - 2012, Dilovan Matini
*
* Date: Wednesday, ‎December ‎28, ‎2011
#************************************************/
if(!$.DM){$.DM={}}var ie6=($.browser.msie&&$.browser.version>=6&&$.browser.version<7)?true:false,ie8=($.browser.msie&&$.browser.version<9)?true:false,ie9=($.browser.msie&&$.browser.version>=9)?true:false,opera=$.browser.opera,mozilla=$.browser.mozilla,webkit=$.browser.webkit,oldBrowser=(($.browser.msie&&$.browser.version<6)||(opera&&$.browser.version<8)||(mozilla&&$.browser.version<2)||($.browser.safari&&$.browser.version<3))?true:false,xload=(typeof xcode!="undefined"?xcode:"?x=1.01");$.DM.editor={version:"1.01",type:"advanced",rand:DM.rand(),place:false,toolbarPlace:false,bodyPlace:false,box:false,boxName:"",tempSel:false,tempSelType:false,path:"",toolbox:"",userCSSText:"",setting:{outPlace:"editorPlace",width:"900",height:"400",dir:"",align:"",disalign:"",margin:"4px",outBorder:"#c3c3c3",overBorder:"#606060",upBG:"",downBG:"",ajaxFile:"ajax.php",cssFile:"style.min.css",userCSS:{textAlign:"",fontWeight:"bold",fontFamily:"arial",fontSize:"15px",color:"#000"},previewText:"DM Editor v1.01",editorMode:"WYSI",basicHTML:"<html><head></head><body><div></div></body></html>"},use:{fontName:true,fontSize:true,iconLibrary:true,copy:true,paste:true,bold:true,italic:true,underline:true,strikeThrough:true,justifyLeft:true,justifyCenter:true,justifyRight:true,line:true,numberList:true,bullList:true,foreColor:true,backColor:true,symbol:true,image:true,link:true,table:true,phpCode:true,userStyle:true,editorMode:false},fonts:[["tahoma","Tahoma"],["arial","Arial"],["arial black","Arial Black"],["akhbar MT","Akhbar"],["arabic transparent","Basit"],["comic sans ms","Comic"],["courier new","Courier New"],["diwani letter","Diwani"],["arial narrow","Narrow"],["times new roman","Times"],["monotype kufi","Kufi"],["andalus","Andalus"],["old antic bold","Antic"],["verdana","Verdana"],["wingdings","Wingdings"]],sizes:[8,9,10,11,12,13,14,15,16,18,20,22,24,28,32,40,48,60,72],smiles:[["8ball.gif","angry.gif","approve.gif"],["big.gif","blackeye.gif","blush.gif"],["wink.gif","cool.gif","crying.gif"],["dead.gif","dissapprove.gif","evil.gif"],["eyebrows.gif","hearteyes.gif","icon.gif"],["waving2.gif","kisses.gif","nono.gif"],["question.gif","rotating.gif","sad.gif"],["shock.gif","shy.gif","sleepy.gif"],["tongue.gif","wailing.gif","waving.gif"]],setImages:function(){var b=this.path,a=xload;this.img={blank:b+"assets/blank.gif"+a,progress:b+"assets/progress.gif"+a,success:b+"assets/success.gif"+a,error:b+"assets/error.gif"+a,buttons:b+"assets/editor-buttons.gif"+a,buttonBack:b+"assets/editor-buttons-back.gif"+a,buttonBackDown:b+"assets/editor-buttons-back-down.gif"+a}},resize:function(){$(function(){var f=DMEditor,b=f.setting,a=b.width+"",e=b.height+"",j=parseInt(a),d=parseInt(e),i=h=0,c=$I("#"+b.outPlace),g=(parseInt(b.margin)||0)*2;if(isNaN(j)||j<1){j=900}if(isNaN(d)||d<1){d=400}if(c){i=$(c).width()-g-25;h=$(c).height()-g-5;if(a.indexOf("%")>=0&&i>0){j=(j>=100)?i:(i/100)*j}if(e.indexOf("%")>=0&&h>0){d=(d>=100)?h:(h/100)*d}}b.width=j;b.height=d;$(f.place).css({width:j+"px",height:d+"px"});$(f.toolbarPlace).css({width:j+"px"});$(f.bodyPlace).css({width:j+"px",height:(d-30)+"px"});$(f.box).css({width:j+"px",height:(d-32)+"px"})})},setDefault:function(f){var d=this;DM.extend(d,f);d.path=DM.path+"editor/";d.setImages();var e=d.setting,b=d.img,a=e.align.toLowerCase(),c=["right","left"];e.dir=(e.dir=="")?($("html").attr("dir")=="rtl"?"rtl":"ltr"):e.dir;e.align=(c.inArray(a))?a:((e.dir=="rtl")?"right":"left");e.disalign=(e.align=="right")?"left":"right";if(e.upBG==""){e.upBG="#f1f0f0 url("+b.buttonBack+") repeat-x"}if(e.downBG==""){e.downBG="#f1f0f0 url("+b.buttonBackDown+") repeat-x"}d.setUserCSS(e.userCSS)},run:function(d){this.setDefault(d);var b=this,a=b.rand,c=b.setting;document.write('<link rel="stylesheet" type="text/css" href="'+b.path+"assets/"+c.cssFile+xload+'" /><div id="editorPlace'+a+'" class="DMEditor" style="margin:'+c.margin+";border:"+c.outBorder+' 1px solid;" dir="'+c.dir+'">');if(oldBrowser){document.write("<center><nobr>متصفحك غير ملائم لتقنية هذا المحرر<br>يجب عليك تحميل أحد متصفحات الداعمة لتقنية هذا المحرر<br>المتصفحات الداعمة لهذا المحرر:-<br>Internet Explorer v6 to latest versions<br>Mozilla v2 to latest versions<br>Opera v8 to latest versions<br>Safari v3 to latest versions<br>Google chrome all versions.</nobr></center>");return}document.write('<div id="toolbarPlace'+a+'" class="toolbar" style="border-bottom:'+c.outBorder+' 1px solid;" dir="ltr"></div><div id="editorBody'+a+'" class="body" style="border-bottom:'+c.outBorder+' 1px solid;"><iframe id="contentPlace'+a+'" name="contentPlace'+a+'" contentEditable="true" noborder></iframe></div><iframe id="contentTempPlace'+a+'" name="contentTempPlace'+a+'" class="tempBox" contentEditable="true"></iframe></div>');b.place=$I("#editorPlace"+a);$(b.place).hide();b.toolbarPlace=$I("#toolbarPlace"+a);b.bodyPlace=$I("#editorBody"+a);b.boxName="contentPlace"+a;b.box=$I("#"+b.boxName);b.toolbar.create();b.setContent(c.basicHTML);b.resize();$(function(){$(b.place).show();if(b.type=="advanced"){b.focus()}})},eBox:function(obj){return eval(obj)},setContent:function(c){var f=this,b=f.eBox(f.boxName),a=f.eBox("contentTempPlace"+f.rand),d=f.setting.style,e;if("designMode" in a.document){a.document.designMode="on"}e=a.document.open("text/html","replace");e.write(c);e.close();e=b.document.open("text/html","replace");e.write($(a.document.documentElement).html());e.close();if("spellcheck" in b.document.body){b.document.body.spellcheck=false}if("contentEditable" in b.document.body){b.document.body.contentEditable=true}else{if("designMode" in b.document.body.contentWindow.document){b.document.body.contentWindow.document.designMode="on"}}if("oncontextmenu" in b.document.body){b.document.body.oncontextmenu=function(){return false}}if(ie8){b.document.execCommand("2D-Position",true,true);b.document.execCommand("MultipleSelection",true,true);b.document.execCommand("LiveResize",true,true)}$(b.document.body).keypress(function(i){if(i.which==13){f.focus();if(ie8){f.pasteHTML("<br>",true)}else{if(mozilla||ie9){var g=f.getRange();g.deleteContents();g.insertNode("<br>")}else{return true}}return false}});$(b.document.body).focus(function(){f.hideBoxes()});f.setCSSText("WYSI")},getContent:function(j){var f=this,a=f.eBox(f.boxName),e=f.eBox("contentTempPlace"+f.rand),k,g,d=[["div",0],["p",0],["span",1],["font",1]],i=["padding-top: 0px;","padding-right: 0px;","padding-bottom: 0px;","padding-left: 0px;","border-top-width: 0px;","border-right-width: 0px;","border-bottom-width: 0px;","border-left-width: 0px;","border-left-width: 0px;","margin: 0px;","border-image: initial"];j=(j===true)?true:false;if(j){k=a.document.documentElement}else{k=e.document.open("text/html","replace");k.write($(a.document.documentElement).html());k.close();k=e.document.documentElement}g=$(k).html();g=g.substr(g.toLowerCase().indexOf("<body")+1);g=g.substr(g.indexOf(">")+1);if(g.substr(0,2)=="\r\n"){g=g.substr(2)}g=g.substr(0,g.toLowerCase().indexOf("</body>"));for(var c=0,b;c<i.length;c++){b=new RegExp(i[c],"gim");g=g.replace(b,"")}g=g.replace(/\s*style="\s*"/gim,"");for(var c=0,b;c<d.length;c++){b=new RegExp("<s*"+d[c][0]+"s*>s*</"+d[c][0]+">","gim");g=g.replace(b,"");if(d[c][1]===1){b=new RegExp("<s*"+d[c][0]+"s*>(.*)</"+d[c][0]+">","gim");g=g.replace(b,"$1")}}g=g.replace(/<img border=([0-9]*)/gim,'<img style="border:#000 $1px solid;"');g=g.replace(/style="([^"]*)"/gim,function(p,t){var r=[],q,m,n,s=[],v=["border-top","border-right","border-bottom","border-left"],o=["padding-top","padding-right","padding-bottom","padding-left"],u=function(y){arr=s[y];if(arr.length==4&&arr[0][1]==arr[1][1]&&arr[0][1]==arr[2][1]&&arr[0][1]==arr[3][1]){r[r.length]=y+":"+arr[0][1]}else{for(var w=0;w<arr.length;w++){r[r.length]=arr[w][0]+":"+arr[w][1]}}};t=t.replace("\n","").replace("\t","").replace("\r","");t=t.split(";");s.border=[];s.padding=[];for(var l=0;l<t.length;l++){q=t[l].trim();if(q.indexOf(":")>=0){q=q.split(":");m=q[0].toLowerCase();n=q[1];if(v.inArray(m)){s.border[s.border.length]=[m,n]}else{if(o.inArray(m)){s.padding[s.padding.length]=[m,n]}else{r[r.length]=m+":"+n}}}}u("border");u("padding");t=r.join(";");t='style="'+t+'"';return t});if(!j){g=g.replace(/^\s*<br>/gim,"")}return(j)?g.length:g},setCSSText:function(a){var f=this,g="",l=f.setting.userCSS,e="",d=(a=="WYSI")?l.textAlign:"left",j=(a=="WYSI")?l.fontWeight:"normal",k=(a=="WYSI")?l.fontFamily:"'Courier New',tahoma",i=(a=="WYSI")?l.fontSize:"15px",b=(a=="WYSI")?l.color:"#000",c=(a=="WYSI")?f.setting.dir:"ltr";e="text-align:"+d+";font-weight:"+j+";font-family:"+k+";font-size:"+i+";color:"+b+";";f.userCSSText=e;g="margin:0;padding:0;border-width:0;background-color:#fff;"+e+"direction:"+c+";";f.eBox(f.boxName).document.body.style.cssText=g},editorMode:function(){var d=this,c=d.setting;d.hideBoxes();var a=d.eBox(d.boxName);if(c.editorMode=="WYSI"){var b=d.getContent();$(a.document.body).text(b);d.setCSSText("HTML");d.toolbar.disable(true,"*","editorMode");c.editorMode="HTML"}else{d.setContent($(a.document.body).text());d.setCSSText("WYSI");d.toolbar.disable(false,"*","editorMode");c.editorMode="WYSI"}},setUserCSS:function(e){var b=this,d=b.setting,c=d.userCSS,a=function(g,k,i){var j="",f,l=e[g];l=($T(l)=="string")?l.toLowerCase():"";if(l!=""&&!i||i&&i.inArray(l)){if(g=="fontSize"){f=parseInt(l)||0;l=(f>0)?f+"px":k}j=l}else{j=k}return j};if(e){c.textAlign=a("textAlign",d.align,["right","left","center"]);c.fontWeight=a("fontWeight","bold",["bold","normal"]);c.fontFamily=a("fontFamily","arial");c.fontSize=a("fontSize","15px");c.color=a("color","#000")}},toolbar:{place:false,buttons:[],buttonsArr:[["fontName",-1,"نمط الخط","doFontName();"],["fontSize",-1,"حجم الخط","doFontSize();"],["iconLibrary",512,"مكتبة آيقونات","doInsertIcons();"],["copy",64,"نسخ","setCommand('Copy');"],["paste",80,"لصق","setCommand('Paste');"],["bold",208,"خط ثقيل","setCommand('Bold');"],["italic",224,"خط مائل","setCommand('Italic');"],["underline",240,"تحته خط","setCommand('Underline');"],["strikeThrough",256,"عليه خط","setCommand('Strikethrough');"],["justifyLeft",368,"في اليسار","setCommand('JustifyLeft');"],["justifyCenter",384,"في الوسط","setCommand('JustifyCenter');"],["justifyRight",400,"في اليمين","setCommand('JustifyRight');"],["numberList",304,"قائمة مرقمة","setCommand('InsertOrderedList');"],["bullList",320,"قائمة","setCommand('InsertUnorderedList');"],["line",496,"أدخل خط أفقي","setCommand('InsertHorizontalRule');"],["foreColor",704,"لون النص","doForeColor();"],["backColor",544,"لون خلفية النص","doBackColor();"],["symbol",528,"ادخل شعار","doInsertSymbol();"],["image",576,"ادخل او غير صورة","doImage.open();"],["link",432,"ادخل وصلة","doLink.open();"],["table",480,"أدخل او غير جدول","doTable.open();"],["phpCode",688,"ادخل شيفرة PHP","doPHPCode.open();"],["userStyle",720,"خصائص العرض","userStyle.open();"],["editorMode",672,"عرض شيفرات لغة HTML","editorMode();"]],create:function(){var k=DMEditor,d=k.toolbar,c=k.setting,i=d.buttonsArr,f="";d.place=k.toolbarPlace;f+='<table cellpadding="3" cellspacing="2"><tr>';$.each(i,function(b,s){var m=s[0],o=k.eBox("DMEditor.use."+m),n=s[1],r=s[2],q="DMEditor."+s[3],p="";if(o===true){if(n==-1){p=d.setArrow("<nobr>"+r+"</nobr>")}else{p='<img class="buttonImg" src="'+k.img.blank+'" style="background:url('+k.img.buttons+") no-repeat 0 -"+n+'px;">'}if(m=="iconLibrary"){p=d.setArrow(p)}f+='<td id="buttonCell'+m+'" buttonid="'+m+'" tip="'+r+'" cmd="'+q+'" class="buttonCell" style="border:'+c.outBorder+" 1px solid;background:"+c.upBG+';"><div id="buttonDiv'+m+'" buttonid="'+m+'" class="buttonDiv">'+p+"</div></td>"}});f+="</tr></table>";$(d.place).html(f);d.tips=[];d.buttons.store=[];for(var g=0;g<i.length;g++){var a=i[g][0],e=$I("#buttonCell"+a),l=$I("#buttonDiv"+a),j="button"+a+"Tip";d.buttons[a]={id:a,button:e,disabled:false,disable:function(b){if(b===true){$("#buttonDiv"+this.id).css({opacity:0.4});this.disabled=true}else{$("#buttonDiv"+this.id).css({opacity:1});this.disabled=false}}};d.buttons.store[g]=a;$(l).append('<div id="'+j+'" class="buttonTip" style="border:'+c.outBorder+' 1px solid;" dir="'+c.dir+'"><nobr>'+i[g][2]+"</nobr></div>");$("#"+j).hide();d.tips[g]=j;$(l).hover(function(){var b=$(this).attr("buttonid");if(!d.disabled(b)){$("#button"+b+"Tip").fadeIn("slow").show()}},function(){var b=d.tips;$.each(b,function(n,m){$("#"+m).hide()})});$(e).mouseout(function(){var b=$(this).attr("buttonid");if(!d.disabled(b)){$(this).css("border",c.outBorder+" 1px solid")}});$(e).mouseover(function(){var b=$(this).attr("buttonid");if(!d.disabled(b)){$(this).css("border",c.overBorder+" 1px solid")}});$(e).mouseup(function(){var b=$(this).attr("buttonid");if(!d.disabled(b)){$(this).css("background",c.upBG);if(k.toolbox==b){k.toolbox=""}else{k.eBox($(this).attr("cmd"))}}});$(e).mousedown(function(){var b=$(this).attr("buttonid");if(!d.disabled(b)){$(this).css("background",k.setting.downBG)}})}$("#toolbarPlace"+k.rand+" *").attr("unselectable","on")},disable:function(e,j,f){var g=[],a=[],i=false,d=this.buttons.store,c;e=(e===true)?true:false;if($T(j)==="string"){if(j=="*"){i=true}else{g[g.length]=j}}else{if($T(j)==="array"){g=j}else{i=true}}if($T(f)==="string"){a[a.length]=f}else{if($T(f)==="array"){a=f}}$.each(d,function(b,k){if($.inArray(k,a)==-1){if(i||$.inArray(k,g)>=0){DMEditor.toolbar.buttons[k].disable(e)}}})},disabled:function(b){var a=(this.buttons[b].disabled===true)?true:false;return a},setArrow:function(a){var b='<table cellpadding="0" cellspacing="0"><tr><td class="buttonText">'+a+'</td><td><img class="buttonArrow" src="'+DMEditor.img.blank+'"></td></tr></table>';return b}},hideBoxes:function(){var a=["fontNameBox","fontSizeBox","iconLibraryBox"];$.each(a,function(c,b){$("#"+b).css("visibility","hidden")});DM.container.close();this.toolbox=""},getDoc:function(){var b=this.box,a=false;if(b){try{if(b.contentWindow&&b.contentWindow.document){a=b.contentWindow.document;return a}}catch(c){}}return false},getWindow:function(){var a=this.box,b=false;if(a&&a.contentWindow){b=a.contentWindow}return b},focus:function(){this.getWindow().focus()},getSelection:function(){var b=this,a=null;if(b.getDoc()&&b.getWindow()){if(b.getDoc().selection){a=b.getDoc().selection}else{a=b.getWindow().getSelection()}if(webkit){if(a.baseNode){b.checkSel={baseNode:a.baseNode,baseOffset:a.baseOffset,extentNode:a.extentNode,extentOffset:a.extentOffset}}else{if($T(b.checkSel)!=="undefined"&&b.checkSel!=null){a=b.getWindow().getSelection();a.setBaseAndExtent(b.checkSel.baseNode,b.checkSel.baseOffset,b.checkSel.extentNode,b.checkSel.extentOffset);b.checkSel=null}}}}return a},getRange:function(){var f=this,d=f.getSelection();if(d===null){return null}if(webkit&&!d.getRangeAt){var a=f.getDoc().createRange();try{a.setStart(d.anchorNode,d.anchorOffset);a.setEnd(d.focusNode,d.focusOffset)}catch(c){a=f.getWindow().getSelection()+""}return a}if(ie8){try{return d.createRange()}catch(b){return null}}if(opera){try{return d.getRangeAt(0)}catch(b){return null}}if(d.rangeCount>0){return d.getRangeAt(0)}return null},pasteHTML:function(j,e){var g=this;if(ie8){var i=g.getRange(),c,k;if(e===true){i.pasteHTML(j);i.select();i.moveEnd("character",1);i.moveStart("character",1);i.collapse(false)}else{if(g.tempSel){i=g.tempSel}i=g.fixSel(i);c=g.fixSelType(i,c);k=(c=="None")?g.getDoc():i;i.select();k.pasteHTML(j)}}else{var f=g.getDoc().createDocumentFragment();var l=g.getDoc().createElement("div");l.innerHTML=j;while(l.firstChild){f.appendChild(l.firstChild)}var i=g.getSelection(),a;if(i.rangeCount>0){a=i.getRangeAt(0)}else{a=g.getRange()}if(a===null){return}i.removeAllRanges();a.deleteContents();var b=a.startContainer;var d=a.startOffset;if(b.nodeType==3){if(f.nodeType==3){b.insertData(d,f.data);a.setEnd(b,d+f.length);a.setStart(b,d+f.length)}else{b=b.splitText(d);b.parentNode.insertBefore(f,b);if(!opera){a.setEnd(b,d+f.length);a.setStart(b,d+f.length)}}}else{if(b.nodeType==1){if(mozilla){a.insertNode($((j.indexOf("<")!=0)?$("<span/>").append(j):j)[0])}else{a.insertNode($(g.getDoc().createElement("span")).append($((j.indexOf("<")!=0)?"<span>"+j+"</span>":j))[0])}}}i.addRange(a)}},hasSelection:function(){var c=this.getSelection(),a=this.getRange(),b=false;if(!c||!a){return b}if($.browser.msie||opera){if(a.text){b=true}if(a.html){b=true}}else{if(webkit){if(c+""!==""){b=true}}else{if(c&&(c.toString()!=="")&&($T(c)!=="undefined")){b=true}}}return b},getTarget:function(b){var a=b.target||b.srcElement;try{if(a&&a.nodeType==3){return a.parentNode}}catch(b){}return a},isElement:function(b,a){if(b&&b.tagName&&(b.tagName.toLowerCase()==a)){return true}if(b&&b.getAttribute&&(b.getAttribute("tag")==a)){return true}return false},getSelectedElement:function(){var f=this,j=f.getDoc(),i=null,g=null,b=null,c=true;if(ie8){f.currentEvent=f.getWindow().event;i=f.getRange();if(i){b=i.item?i.item(0):i.parentElement();if(b===j.body){b=null}}if((f.currentEvent!==null)&&(f.currentEvent.keyCode===0)){b=f.getTarget(f.currentEvent)}}else{g=f.getSelection();i=f.getRange();if(!g||!i){return null}if($.browser.gecko){if(i.startContainer){if(i.startContainer.nodeType===3){b=i.startContainer.parentNode}else{if(i.startContainer.nodeType===1){b=i.startContainer}}if(f.currentEvent){var a=f.getTarget(f.currentEvent);if(!f.isElement(a,"html")){if(b!==a){b=a}}}}}if(c){if(g.anchorNode&&(g.anchorNode.nodeType==3)){if(g.anchorNode.parentNode){b=g.anchorNode.parentNode}if(g.anchorNode.nextSibling!=g.focusNode.nextSibling){b=g.anchorNode.nextSibling}}if(f.isElement(b,"br")){b=null}if(!b){b=i.commonAncestorContainer;if(!i.collapsed){if(i.startContainer==i.endContainer){if(i.startOffset-i.endOffset<2){if(i.startContainer.hasChildNodes()){b=i.startContainer.childNodes[i.startOffset]}}}}}}}if(f.currentEvent!==null){try{if(f.currentEvent.type=="click"||f.currentEvent.type=="mousedown"||f.currentEvent.type=="mouseup"){if(webkit){b=f.getTarget(f.currentEvent)}}}catch(d){}}if(opera||webkit){if(f.currentEvent&&!b){b=f.getTarget(f.currentEvent)}}if(!b||!b.tagName){b=j.body}if(f.isElement(b,"html")){b=j.body}if(f.isElement(b,"body")){b=j.body}if(b&&!b.parentNode){b=j.body}if($T(b)==="undefined"){b=null}return b},setCommand:function(i,c,d,e){var f=this;f.hideBoxes();if(ie8){var a=f.eBox(f.boxName),j=(e!=null&&e==2);if(j){var g=f.tempSel;var e=f.tempSelType}else{var g=a.document.selection.createRange(),e=a.document.selection.type}g=f.fixSel(g);e=f.fixSelType(g,e);var b=(e=="None")?a.document:g;if(j){g.select()}b.execCommand(i,false,d)}else{if(i=="BackColor"){i="hilitecolor"}f.focus();f.getDoc().execCommand(i,c||false,d||null)}},fixSel:function(a){var b=this.eBox(this.boxName);if(a.parentElement!=null){if(!this.isInsideEditor(a.parentElement())){b.focus();var a=b.document.selection.createRange()}}else{if(!this.isInsideEditor(a.item(0))){b.focus();var a=b.document.selection.createRange()}}return a},fixSelType:function(b,a){var c=this.eBox(this.boxName);if(b.parentElement!=null){if(!this.isInsideEditor(b.parentElement())){c.focus();var a=c.document.selection.type}}else{if(!this.isInsideEditor(b.item(0))){c.focus();var a=c.document.selection.type}}return a},isInsideEditor:function(a){while(a!=null){if(a.tagName=="BODY"&&a.contentEditable=="true"){return true}a=a.parentElement}return false},msieSelection:function(){if(ie8){var a=this.eBox(this.boxName);this.tempSel=a.document.selection.createRange();this.tempSelType=a.document.selection.type}},doFontName:function(){var e=this,d=e.setting;if(e.use.fontName===true){e.hideBoxes();e.msieSelection();e.toolbox="fontName";var c=$I("#fontNameBox"),b=e.fonts;if(!c){var a="";$.each(b,function(g,f){a+="<tr><td onclick=\"DMEditor.setCommand('FontName',null,'"+f[0]+'\',2);" style="border:'+d.outBorder+" 1px solid;padding:2px 5px;text-align:left;cursor:pointer;font:normal 11px tahoma;background:"+d.upBG+';"><nobr>'+f[1]+"</nobr></td></tr>"});$("#buttonDivfontName").append('<div id="fontNameBox" style="position:absolute;left:-5px;top:21px;"><table width="100%" cellspacing="1" cellpadding="0">'+a+"</table></div>");$("#fontNameBox td").mouseout(function(){$(this).css("border",d.outBorder+" 1px solid")});$("#fontNameBox td").mouseover(function(){$(this).css("border",d.overBorder+" 1px solid")})}else{$(c).css("visibility","visible")}}},doFontSize:function(){var e=this,d=e.setting;if(e.use.fontSize===true){e.msieSelection();e.hideBoxes();e.toolbox="fontSize";var c=$I("#fontSizeBox");if(!c){var b="";for(var a=1;a<=7;a++){b+="<tr><td onclick=\"DMEditor.setCommand('FontSize',null,'"+a+'\',2);" style="border:'+d.outBorder+" 1px solid;padding:1px 20px;text-align:center;cursor:pointer;font:normal 11px tahoma;background:"+d.upBG+';"><nobr>'+a+"</nobr></td></tr>"}$("#buttonDivfontSize").append('<div id="fontSizeBox" style="position:absolute;left:-5px;top:21px;"><table width="100%" cellspacing="1" cellpadding="0">'+b+"</table></div>");$("#fontSizeBox td").mouseout(function(){$(this).css("border",d.outBorder+" 1px solid")});$("#fontSizeBox td").mouseover(function(){$(this).css("border",d.overBorder+" 1px solid")})}else{$(c).css("visibility","visible")}}},doInsertIcons:function(){var f=this,e=f.setting;if(f.use.iconLibrary===true){f.msieSelection();f.hideBoxes();f.toolbox="iconLibrary";var c=$I("#iconLibraryBox"),a=f.smiles,b="",d="";if(!c){$.each(a,function(j,g){b+="<tr>";$.each(g,function(l,k){d=f.path+"assets/smiles/"+k;b+='<td img="'+d+'" style="border:'+e.outBorder+" 1px solid;padding:2px;text-align:center;cursor:pointer;font:normal 11px tahoma;background:"+e.upBG+';"><img src="'+d+'" width="22" height="22"></td>'});b+="</tr>"});$("#buttonDiviconLibrary").append('<div id="iconLibraryBox" style="position:absolute;left:-5px;top:21px;"><table width="100%" cellspacing="1" cellpadding="0">'+b+"</table></div>");$("#iconLibraryBox td").mouseout(function(){$(this).css("border",e.outBorder+" 1px solid")});$("#iconLibraryBox td").mouseover(function(){$(this).css("border",e.overBorder+" 1px solid")});$("#iconLibraryBox td").mouseup(function(){f.doImage.insert({src:$(this).attr("img"),hspace:5})})}else{$(c).css("visibility","visible")}}},doForeColor:function(){var b=this,a=DM.container;if(b.use.foreColor===true){b.hideBoxes();b.msieSelection();a.open({header:"لون النص",body:DM.colorPicker.panel("ForeColor"),buttons:[{value:"إدخال",color:"dark",click:function(){b.setCommand("ForeColor",null,DM.colorPicker.getColor("ForeColor"),2)}},{value:"إلغاء الأمر",click:function(){a.close()}}]})}},doBackColor:function(){var b=this,a=DM.container;if(b.use.backColor===true){b.hideBoxes();b.msieSelection();a.open({header:"لون خلفية النص",body:DM.colorPicker.panel("BackColor"),buttons:[{value:"إدخال",color:"dark",click:function(){b.setCommand("BackColor",null,DM.colorPicker.getColor("BackColor"),2)}},{value:"إلغاء الأمر",click:function(){a.close()}}]})}},doInsertSymbol:function(){var c=this;if(c.use.symbol===true){c.hideBoxes();c.msieSelection();var a=[["&quot;","&amp;","&lt;","&gt;","&euro;","&iexcl;","&cent;","&pound;","&curren;","&yen;"],["&brvbar;","&sect;","&uml;","&copy;","&ordf;","&laquo;","&not;","&shy;","&reg;","&macr;"],["&deg;","&plusmn;","&sup2;","&sup3;","&acute;","&micro;","&para;","&middot;","&cedil;","&sup1;"],["&ordm;","&raquo;","&frac14;","&frac12;","&frac34;","&iquest;","&Agrave;","&Aacute;","&Acirc;","&Atilde;"],["&Auml;","&Aring;","&AElig;","&Ccedil;","&Egrave;","&Eacute;","&otilde;","&Euml;","&Igrave;","&Iacute;"],["&Icirc;","&ouml;","&ETH;","&Ntilde;","&Ograve;","&Oacute;","&ntilde;","&Otilde;","&Ouml;","&times;"],["&Oslash;","&Ugrave;","&Uacute;","&ograve;","&Uuml;","&Yacute;","&THORN;","&szlig;","&agrave;","&aacute;"],["&acirc;","&atilde;","&auml;","&aring;","&aelig;","&eth;","&egrave;","&eacute;","&oacute;","&euml;"],["&#202;","&#206;","&#212;","&#219;","&#350;","&#1194;","&yuml;","&thorn;","&yacute;","&uuml;"],["&#234;","&#238;","&#244;","&#251;","&#351;","&#1195;","&divide;","&oslash;","&ugrave;","&uacute;"],["&#1700;","&#1742;","&#1740;","&#1734;","&#1688;","&#1711;","&#1717;","&#1607;&#173;","&#1662;","&#1670;"]];var b='<table cellspacing="0" cellpadding="0" bgcolor="#ffffff" style="border:#a9a9a9 1px solid;">';$.each(a,function(e,d){b+="<tr>";$.each(d,function(g,f){b+='<td align="center" onclick="DMEditor.inserSymbolClick(this);" onmouseover="this.style.border=\'#a9a9a9 1px solid\';" onmouseout="this.style.border=\'#f0f4fb 1px solid\';" style="border:#f0f4fb 1px solid;padding:2px 5px;font:normal 12px tahoma,arial;cursor:pointer;">'+f+"</td>"});b+="</tr>"});b+="</table>";c.inserSymbolClick=function(d){c.focus();c.pasteHTML("&#"+$(d).text().charCodeAt(0)+";");c.hideBoxes()};DM.container.open({header:"ادخل شعار",body:b,padding:"6px"})}},doLink:{link:null,mode:"create",open:function(){var g=DMEditor,f=g.doLink,c=DM.container;if(g.use.link===true){g.hideBoxes();g.msieSelection();var n=g.getSelectedElement(),d=(n)?n.tagName.toLowerCase():"",b=(n&&d=="a")?n:false,k=false,a={},l=g.hasSelection(),e=g.rand,j="";f.mode=(b)?"update":"create";f.link=(b)?b:null;if(d!="body"){if(n){k=$(n).parent().get(0)}}else{k=n}a.protocol=(b)?"":"http://";a.href=(b)?b.href:"";a.text="";a.title=(b)?b.title:"";a.name=(b)?b.name:"";j='<table cellspacing="2" cellpadding="2"><tr><td class="DMTitle"><nobr>الرابط</nobr></td><td class="DMText" dir="ltr"><nobr><select class="DMSelect" id="linkProtocol'+e+'" style="width:70px;"></select>&nbsp;<input type="text" class="DMInput" id="linkHref'+e+'" style="width:300px;"></nobr></td></tr><tr id="linkTextRow'+e+'"><td class="DMTitle"><nobr>نص رابط</nobr></td><td class="DMText"><input type="text" class="DMInput" id="linkText'+e+'" style="width:373px;"></td></tr><tr><td class="DMTitle"><nobr>شرح رابط</nobr></td><td class="DMText"><input type="text" class="DMInput" id="linkTitle'+e+'" style="width:373px;"></td></tr><tr><td class="DMTitle"><nobr>اسم رابط</nobr></td><td class="DMText"><input type="text" class="DMInput" id="linkName'+e+'" style="width:373px;" dir="ltr"></td></tr></table>';c.open({header:"إنشاء او تعديل رابط",body:j,padding:"10px",buttons:[{value:(f.mode=="update"?"تعديل رابط":"إنشاء رابط"),color:"dark",click:function(){var o={protocol:$("#linkProtocol"+e).val(),href:$("#linkHref"+e).val(),text:$("#linkText"+e).val(),title:$("#linkTitle"+e).val(),name:$("#linkName"+e).val()};if(f.mode=="update"){f.update(o)}else{f.create(o)}c.close()}},{value:"إلغاء الأمر",click:function(){c.close()}}]});if(f.mode=="update"||l&&$(k).html()!=""){$("#linkTextRow"+e).hide()}$("#linkHref"+e).val(a.href);$("#linkTitle"+e).val(a.title);$("#linkName"+e).val(a.name);var m=$I("#linkProtocol"+e),i=["http://","https://","ftp://","mailto:"];while(m.length>0){m.remove(0)}m.options[0]=new Option("","");$.each(i,function(p,o){m.options[p+1]=new Option(o,o);if(a.protocol==o){m.options.selectedIndex=p+1}});c.dimension()}},create:function(a){var f=DMEditor;if(a&&$T(a.href)!="undefined"){var c="http://dm.duhoktimes.com/temp-link.php",b,i=($T(a.protocol)=="string")?a.protocol:"",g=($T(a.text)=="string")?a.text:"",e=function(k,n,j){var m=n[j],l=$T(m);if(l=="string"&&m!=""){$(k).attr(j,m)}};if(g==""){f.setCommand("createlink",null,c,2)}else{f.focus();f.pasteHTML('<a href="'+c+'">'+g+"</a>")}var d=f.getDoc().getElementsByTagName("a");$.each(d,function(k,j){if(j.href==c){b=j;return false}});$(b).attr("href",i+a.href);e(b,a,"title");e(b,a,"name")}},update:function(d){if(this.link&&d&&$T(d.href)=="string"){var a=this.link,c=($T(d.protocol)=="string")?d.protocol:"",b=function(f,j,e){var i=j[e],g=$T(i);$(f).removeAttr(e);if(g=="string"&&i!=""){$(f).attr(e,i)}};$(a).attr("href",c+d.href);b(a,d,"title");b(a,d,"name")}}},doImage:{image:null,mode:"insert",open:function(){var g=DMEditor,c=g.doImage,b=DM.container;if(g.use.image===true){g.hideBoxes();g.msieSelection();var f=g.getSelectedElement(),i=(f&&f.tagName.toLowerCase()=="img"?f:false),e=g.rand,k="",a={src:"http://",alt:"",align:"",border:"",width:"",height:"",hspace:"",vspace:""};c.mode=(i)?"update":"insert";c.image=(i)?i:null;DM.extend(a,i,false);k='<table cellspacing="2" cellpadding="2"><tr><td class="DMTitle"><nobr>مصدر الصورة</nobr></td><td class="DMText" colspan="3"><input type="text" class="DMInput" id="imageSrc'+e+'" style="width:320px;" dir="ltr"></td></tr><tr><td class="DMTitle"><nobr>شرح الصورة</nobr></td><td class="DMText" colspan="3"><input type="text" class="DMInput" id="imageAlt'+e+'" style="width:320px;"></td></tr><tr><td class="DMTitle"><nobr>وضع الصورة</nobr></td><td class="DMText"><select class="DMSelect" id="imageAlign'+e+'" style="width:110px;"></select></nobr></td><td class="DMTitle"><nobr>حاشية الصورة</nobr></td><td class="DMText"><input type="text" class="DMInput" id="imageBorder'+e+'" style="width:90px;text-align:center;" dir="ltr"></td></tr><tr><td class="DMTitle"><nobr>عرض الصورة</nobr></td><td class="DMText"><input type="text" class="DMInput" id="imageWidth'+e+'" style="width:100px;text-align:center;" dir="ltr"></td><td class="DMTitle"><nobr>تمديد المساحة أفقيا</nobr></td><td class="DMText"><input type="text" class="DMInput" id="imageHSpace'+e+'" style="width:90px;text-align:center;" dir="ltr"></td></tr><tr><td class="DMTitle"><nobr>إرتفاع الصورة</nobr></td><td class="DMText"><input type="text" class="DMInput" id="imageHeight'+e+'" style="width:100px;text-align:center;" dir="ltr"></td><td class="DMTitle"><nobr>تمديد المساحة عموديا</nobr></td><td class="DMText"><input type="text" class="DMInput" id="imageVSpace'+e+'" style="width:90px;text-align:center;" dir="ltr"></td></tr></table>';b.open({header:"ادخل او تعديل صورة",body:k,padding:"10px",buttons:[{value:(c.mode=="update"?"غيّر الصورة الحالية":"أدخل الصورة"),color:"dark",click:function(){var l={src:$("#imageSrc"+e).val(),alt:$("#imageAlt"+e).val(),align:$("#imageAlign"+e).val(),border:$("#imageBorder"+e).val(),width:$("#imageWidth"+e).val(),height:$("#imageHeight"+e).val(),hspace:$("#imageHSpace"+e).val(),vspace:$("#imageVSpace"+e).val()};if(c.mode=="update"){c.update(l)}else{c.insert(l)}b.close()}},{value:"إلغاء الأمر",click:function(){b.close()}}]});$("#imageSrc"+e).val(a.src);$("#imageAlt"+e).val(a.alt);$("#imageBorder"+e).val(a.border);$("#imageWidth"+e).val(a.width);$("#imageHeight"+e).val(a.height);$("#imageHSpace"+e).val(a.hspace);$("#imageVSpace"+e).val(a.vspace);var j=$I("#imageAlign"+e),d=[["absBottom","أقصى الأسفل"],["absMiddle","وسط دقيق"],["baseline","خط النص"],["bottom","أسفل"],["left","يسار"],["middle","وسط"],["right","يمين"],["textTop","أعلى النص"],["top","أقصى الأعلى"]];while(j.length>0){j.remove(0)}j.options[0]=new Option("غير محدد","");$.each(d,function(m,l){j.options[m+1]=new Option(l[1],l[0]);if(a.align==l[0]){j.options.selectedIndex=m+1}})}},insert:function(f){var c=DMEditor;if(f&&$T(f.src)!="undefined"){var d="http://dm.duhoktimes.com/temp-image.gif",e,b=function(k,l,g){var j=l[g],i=$T(j);if(i=="string"&&j!=""||i=="number"&&j>0){$(k).attr(g,j)}};c.setCommand("insertimage",null,d,2);var a=c.getDoc().getElementsByTagName("img");$.each(a,function(j,g){if(g.src==d){e=g;return false}});e.src=f.src;b(e,f,"alt");b(e,f,"align");b(e,f,"border");b(e,f,"width");b(e,f,"height");b(e,f,"hspace");b(e,f,"vspace")}},update:function(c){var b=this.image;if(c&&b){var a=function(g,i,d){var f=i[d],e=$T(f);$(g).removeAttr(d);if(e=="string"&&f!=""&&f!="0"){$(g).attr(d,f);if(d=="width"||d=="height"){$(g).css(d,f+"px")}}};a(b,c,"src");a(b,c,"alt");a(b,c,"align");a(b,c,"border");a(b,c,"width");a(b,c,"height");a(b,c,"hspace");a(b,c,"vspace")}}},userStyle:{style:{},align:[["right","يمين"],["center","وسط"],["left","يسار"]],weight:[["normal","خفيف"],["bold","ثقيل"]],size:[],fonts:[],open:function(){var e=DMEditor,d=e.userStyle,a=DM.container;if(e.use.userStyle===true){e.hideBoxes();var b=e.setting,j=b.userCSS,i=e.rand,f="",g=function(k,l,o){var m=$I("#style"+k+i),p="",n="";while(m.length>0){m.remove(0)}$.each(l,function(r,q){if($T(q)=="array"){p=q[0];n=q[1]}else{p=(k=="Size")?q+"px":q;n=q}m.options[r]=new Option(n,p);if(p==o){m.options.selectedIndex=r}});return o},c=function(){d.changeStyle("color",this.color)};this.size=e.sizes;this.fonts=e.fonts;f='<table cellspacing="2" cellpadding="2"><tr><td id="previewStyle'+i+'" class="DMText" style="'+e.userCSSText+'padding:10px 4px;" colspan="2"><nobr>'+b.previewText+'</nobr></td></tr><tr><td class="DMTitle"><nobr>اتجاه النص</nobr></td><td class="DMText"><select class="DMSelect" id="styleAlign'+i+'" style="width:100px;" onchange="DMEditor.userStyle.changeStyle(\'textAlign\', $(this).val());"></select></td></tr><tr><td class="DMTitle"><nobr>وزن الخط</nobr></td><td class="DMText"><select class="DMSelect" id="styleWeight'+i+'" style="width:100px;" onchange="DMEditor.userStyle.changeStyle(\'fontWeight\', $(this).val());"></select></td></tr><tr><td class="DMTitle"><nobr>نمط الخط</nobr></td><td class="DMText"><select class="DMSelect" id="styleFamily'+i+'" style="width:100px;" onchange="DMEditor.userStyle.changeStyle(\'fontFamily\', $(this).val());"></select></td></tr><tr><td class="DMTitle"><nobr>حجم النص</nobr></td><td class="DMText"><select class="DMSelect" id="styleSize'+i+'" style="width:100px;" onchange="DMEditor.userStyle.changeStyle(\'fontSize\', $(this).val());"></select></td></tr><tr><td class="DMTitle"><nobr>لون النص</nobr></td><td class="DMText">'+DM.colorPicker.panel("userStyle",{color:j.color,click:c})+"</td></tr></table>";a.open({header:"تغيير نمط النصوص",body:f,footer:'<div id="styleSavePlace'+i+'"></div>',padding:"2px",buttons:[{name:"save",disabled:true,value:"حفظ تغييرات",color:"dark",click:function(){d.saveChanges()}},{value:"إغلاق",click:function(){a.close()}}]});g("Align",this.align,j.textAlign);g("Weight",this.weight,j.fontWeight);g("Family",this.fonts,j.fontFamily);g("Size",this.size,j.fontSize);DM.extend(this.style,j)}},changeStyle:function(a,c){var b=DM.container;$("#previewStyle"+DMEditor.rand).css(a,c);this.style[a]=c;$(b.buttons.save).attr({disabled:false,"class":"dark"});b.dimension()},saveChanges:function(){var e=DMEditor,d=$I("#styleSavePlace"+e.rand),c=this.style,a=e.img,b='<img src="'+a.error+'" width="14" height="14"> حدث خطأ أثناء حفظ تغييرات.';$(d).html('<img src="'+a.progress+'" width="16" height="16"> أنتظر ليتم حفظ تغييرات ...');$.ajax({type:"POST",url:e.setting.ajaxFile,data:"type=style_user_arab_forums&align="+c.textAlign+"&weight="+c.fontWeight+"&family="+c.fontFamily+"&size="+c.fontSize+"&color="+c.color,success:function(f){var f=parseInt(f);if(f==1){$(d).html('<img src="'+a.success+'" width="14" height="14"> تم حفظ تغييرات بنجاح.');$(DM.container.buttons.save).attr({disabled:true,"class":"light"});e.setUserCSS(c);e.setCSSText("WYSI")}else{$(d).html(b)}},error:function(){$(d).html(b)}})}},doPHPCode:{open:function(){var d=DMEditor,a=DM.container;if(d.use.phpCode===true){d.hideBoxes();d.msieSelection();var c=d.rand,b='<div id="phpCodeBox'+c+'" class="DMEditorPHPCode" contentEditable="true" dir="ltr"></div>';a.open({header:"ادخل شيفرة PHP",body:b,footer:'<div id="phpCodePlace'+c+'"></div>',padding:"6px",buttons:[{name:"enter",value:"ادخل شيفرة",color:"dark",click:function(){d.doPHPCode.process()}},{value:"إلغاء الأمر",click:function(){a.close()}}]});$("#phpCodeBox"+c).focus()}},process:function(){var f=DMEditor,b=DM.container,c=f.img,g=$I("#phpCodePlace"+f.rand),d=b.buttons.enter,a=$I("#phpCodeBox"+f.rand),e=(ie8)?a.innerText:$(a).text(),i='<img src="'+c.error+'" width="14" height="14"> حدث خطأ أثناء معالجة شيفرة.';$(g).html('<img src="'+c.progress+'" width="16" height="16">');$(d).attr({disabled:true,"class":"light"});$.ajax({type:"POST",url:f.setting.ajaxFile,data:"type=phpcode_arab_forums&code="+encodeURIComponent(e),success:function(k){var j=k.split("@ARABFORUMS@"),l=(j.length==3)?false:true;if(!l){f.focus();f.pasteHTML(j[1]);b.close()}else{$(d).attr({disabled:false,"class":"dark"});$(g).html(i)}},error:function(){$(d).attr({disabled:false,"class":"dark"});$(g).html(i)}})}},doTable:{menus:{mode:1},body:null,parentElement:"",parentElementTag:"",open:function(){var g=DMEditor,b=DM.container,c=g.doTable;if(g.use.table===true){g.hideBoxes();g.msieSelection();var d=g.rand,e=g.getSelectedElement(),a=(e)?e.tagName.toLowerCase():"body",f="";f+='<table width="540" cellspacing="0" cellpadding="3" bgcolor="#f4f4f4"><tr><td id="tableMenu1'+d+'" class="DMEditorTableMenu">جدول جديد</td><td id="tableMenu2'+d+'" class="DMEditorTableMenu">تعديل خصائص الجدول</td><td id="tableMenu3'+d+'" class="DMEditorTableMenu">تعديل خصائص الخلية</td></tr><tr><td id="tableBody'+d+'" class="DMEditorTableBody" colspan="3"></td></tr></table>';b.open({header:"الجدول",body:f,footer:'<div id="tablePlace'+d+'"></div>',padding:"6px",buttons:[{name:"newTable",value:"أضف جدول",color:"dark",hide:true,click:function(){c.doNewTable()}},{name:"editTable",value:"تعديل جدول",color:"dark",hide:true,click:function(){c.doEditTable()}},{name:"editCell",value:"تعديل خلية",color:"dark",hide:true,click:function(){c.doEditCell()}},{value:"إلغاء الأمر",click:function(){b.close()}}]});c.body=$I("#tableBody"+d);c.parentElement=e;c.parentElementTag=a;c.checkMenus()}},checkMenus:function(){var e=DMEditor,b=e.doTable,c=e.rand,a=b.menus,d=(b.parentElementTag=="td")?true:false;a.newTable=$I("#tableMenu1"+c);a.editTable=$I("#tableMenu2"+c);a.editCell=$I("#tableMenu3"+c);a.mode=(d)?3:1;$(a.newTable).click(function(){b.newTable()});if(d){$(a.editTable).click(function(){b.editTable()});$(a.editCell).click(function(){b.editCell()});b.editCell()}else{b.newTable()}},checkMenusDesign:function(){var f=DMEditor,g=f.doTable,j=g.menus,a=j.mode,e=f.setting.align,c=(g.parentElementTag=="td")?true:false,b="1px 1px 0",i="1px 1px 1px 0",d="1px 0 1px 1px";$(j.newTable).css({"background-color":(a==1)?"#f4f4f4":"#ddd","border-width":(a==1)?b:(e=="right"?i:d)});$(j.editTable).css({"background-color":(a==2)?"#f4f4f4":"#ddd","border-width":(a==2)?b:(e=="right"?(a==1?d:i):(a==1?i:d)),color:(c)?"#000":"#888"});$(j.editCell).css({"background-color":(a==3)?"#f4f4f4":"#ddd","border-width":(a==3)?b:(e=="right"?d:i),color:(c)?"#000":"#888"});g.checkButtons();DM.container.dimension()},checkButtons:function(){var b=this.menus.mode,a=DM.container.buttons;if(b==2){$(a.newTable).hide();$(a.editTable).show();$(a.editCell).hide()}else{if(b==3){$(a.newTable).hide();$(a.editTable).hide();$(a.editCell).show()}else{$(a.newTable).show();$(a.editTable).hide();$(a.editCell).hide()}}},newTable:function(){var e=DMEditor,c=e.doTable,a=DM.colorPicker,d=e.rand,b="";c.menus.mode=1;b='<table width="100%" cellspacing="2" cellpadding="2"><tr><td class="DMTitle"><nobr>عدد الأسطر</nobr></td><td class="DMText"><input type="text" class="DMInput" id="tableRows'+d+'" style="width:50px;text-align:center;" value="2" dir="ltr"></td><td class="DMTitle"><nobr>عدد الأعمدة</nobr></td><td class="DMText"><input type="text" class="DMInput" id="tableCols'+d+'" style="width:50px;text-align:center;" value="2" dir="ltr"></td></tr><tr><td class="DMTitle"><nobr>العرض</nobr></td><td class="DMText"><input type="text" class="DMInput" id="tableWidth'+d+'" style="width:30px;text-align:center;" dir="ltr"><select class="DMSelect" id="tableWidthType'+d+'"><option value="pixel">نقطة</option><option value="percent">نسبة مئوية</option></select></td><td class="DMTitle"><nobr>الارتفاع</nobr></td><td class="DMText"><input type="text" class="DMInput" id="tableHeight'+d+'" style="width:30px;text-align:center;" dir="ltr"><select class="DMSelect" id="tableHeightType'+d+'"><option value="pixel">نقطة</option><option value="percent">نسبة مئوية</option></select></td></tr><tr><td class="DMTitle"><nobr>لون الخلفية</nobr></td><td class="DMText" colspan="3">'+a.panel("tableBackground",{blank:true})+'</td></tr><tr><td class="DMTitle"><nobr>عنوان صورة الخلفية للجدول</nobr></td><td class="DMText" colspan="3"><input type="text" class="DMInput" id="tableBGImage'+d+'" style="width:300px;" dir="ltr"></td></tr><tr><td class="DMTitle"><nobr>حجم الحاشية</nobr></td><td class="DMText"><input type="text" class="DMInput" id="tableBorder'+d+'" style="width:50px;text-align:center;" value="1" dir="ltr"></td><td class="DMTitle"><nobr>تنسيق افقي</nobr></td><td class="DMText"><select class="DMSelect" id="tableAlign'+d+'"><option value=""></option><option value="left">يسار</option><option value="center">وسط</option><option value="right">يمين</option></select></td></tr><tr><td class="DMTitle"><nobr>لون الحاشية</nobr></td><td class="DMText" colspan="3">'+a.panel("tableBorder",{blank:true})+'</td></tr><tr><td class="DMTitle"><nobr>إضافة لحجم الخلايا</nobr></td><td class="DMText"><input type="text" class="DMInput" id="tablePadding'+d+'" style="width:50px;text-align:center;" value="0" dir="ltr"></td><td class="DMTitle"><nobr>المسافة بين الخلايا</nobr></td><td class="DMText"><input type="text" class="DMInput" id="tableSpacing'+d+'" style="width:50px;text-align:center;" value="0" dir="ltr"></td></tr></table>';$(c.body).html(b);c.checkMenusDesign()},doNewTable:function(){var a=DMEditor,j=a.doTable,k=DM.colorPicker,n=a.rand,r=parseInt($("#tableRows"+n).val()),v=parseInt($("#tableCols"+n).val()),u=parseInt($("#tableWidth"+n).val()),e=parseInt($("#tableHeight"+n).val()),g=$("#tableWidthType"+n).val(),s=$("#tableHeightType"+n).val(),t=k.getColor("tableBackground"),o=$("#tableBGImage"+n).val(),l=parseInt($("#tableBorder"+n).val()),b=$("#tableAlign"+n).val(),m=k.getColor("tableBorder"),q=parseInt($("#tablePadding"+n).val()),p=parseInt($("#tableSpacing"+n).val()),c="";r=(isNaN(r))?2:r;v=(isNaN(v))?2:v;u=(isNaN(u)||u==0)?"":' width="'+u+j.percent(g)+'"';e=(isNaN(e)||e==0)?"":' height="'+e+j.percent(s)+'"';t=(t=="")?"":' bgcolor="'+t+'"';o=(o=="")?"":' background="'+o+'"';l=(isNaN(l)||l==0)?"":' border="'+l+'"';b=(b=="")?"":' align="'+b+'"';m=(m=="")?"":' bordercolor="'+m+'"';q=(isNaN(q))?"":' cellpadding="'+q+'"';p=(isNaN(p))?"":' cellspacing="'+p+'"';c+="<table"+u+e+t+o+l+b+m+q+p+">";for(var d=0;d<r;d++){c+="<tr>";for(var f=0;f<v;f++){c+="<td>&nbsp;</td>"}c+="</tr>"}c+="</table>";a.focus();a.pasteHTML(c);DM.container.close()},editTable:function(){var a=DMEditor,i=a.doTable,j=DM.colorPicker,e=DM.choose,m=a.rand,f=$(i.parentElement).parents("table").get(0),s=$(f).attr("width")||"",d=$(f).attr("height")||"",g="pixel",q="pixel",r=$(f).attr("bgcolor")||"",n=$(f).attr("background")||"",k=$(f).attr("border")||"",b=$(f).attr("align")||"",l=$(f).attr("bordercolor")||"",p=$(f).attr("cellPadding")||"",o=$(f).attr("cellSpacing")||"",c="";i.menus.mode=2;if(s.indexOf("%")>=0){s=s.substr(0,s.length-1);g="percent"}if(d.indexOf("%")>=0){d=d.substr(0,d.length-1);q="percent"}c='<table width="100%" cellspacing="2" cellpadding="2"><tr><td class="DMTitle"><nobr>العرض</nobr></td><td class="DMText"><input type="text" class="DMInput" id="tableWidth'+m+'" style="width:30px;text-align:center;" value="'+s+'" dir="ltr"><select class="DMSelect" id="tableWidthType'+m+'"><option value="pixel">نقطة</option><option value="percent"'+e("percent",g)+'>نسبة مئوية</option></select></td><td class="DMTitle"><nobr>الارتفاع</nobr></td><td class="DMText"><input type="text" class="DMInput" id="tableHeight'+m+'" style="width:30px;text-align:center;" value="'+d+'" dir="ltr"><select class="DMSelect" id="tableHeightType'+m+'"><option value="pixel">نقطة</option><option value="percent"'+e("percent",q)+'>نسبة مئوية</option></select></td></tr><tr><td class="DMTitle"><nobr>لون الخلفية</nobr></td><td class="DMText" colspan="3">'+j.panel("tableBackground",{blank:true,color:r})+'</td></tr><tr><td class="DMTitle"><nobr>عنوان صورة الخلفية للجدول</nobr></td><td class="DMText" colspan="3"><input type="text" class="DMInput" id="tableBGImage'+m+'" style="width:300px;" value="'+n+'" dir="ltr"></td></tr><tr><td class="DMTitle"><nobr>حجم الحاشية</nobr></td><td class="DMText"><input type="text" class="DMInput" id="tableBorder'+m+'" style="width:50px;text-align:center;" value="'+k+'" dir="ltr"></td><td class="DMTitle"><nobr>تنسيق افقي</nobr></td><td class="DMText"><select class="DMSelect" id="tableAlign'+m+'"><option value=""></option><option value="left"'+e("left",b)+'>يسار</option><option value="center"'+e("center",b)+'>وسط</option><option value="right"'+e("right",b)+'>يمين</option></select></td></tr><tr><td class="DMTitle"><nobr>لون الحاشية</nobr></td><td class="DMText" colspan="3">'+j.panel("tableBorder",{blank:true,color:l})+'</td></tr><tr><td class="DMTitle"><nobr>إضافة لحجم الخلايا</nobr></td><td class="DMText"><input type="text" class="DMInput" id="tablePadding'+m+'" style="width:50px;text-align:center;" value="'+p+'" dir="ltr"></td><td class="DMTitle"><nobr>المسافة بين الخلايا</nobr></td><td class="DMText"><input type="text" class="DMInput" id="tableSpacing'+m+'" style="width:50px;text-align:center;" value="'+o+'" dir="ltr"></td></tr></table>';$(i.body).html(c);i.checkMenusDesign()},doEditTable:function(){var a=DMEditor,f=a.doTable,g=DM.colorPicker,l=a.rand,d=$(f.parentElement).parents("table").get(0),u=parseInt($("#tableWidth"+l).val()),c=parseInt($("#tableHeight"+l).val()),e=$("#tableWidthType"+l).val(),s=$("#tableHeightType"+l).val(),t=g.getColor("tableBackground"),o=$("#tableBGImage"+l).val(),j=parseInt($("#tableBorder"+l).val()),b=$("#tableAlign"+l).val(),k=g.getColor("tableBorder"),q=parseInt($("#tablePadding"+l).val()),p=parseInt($("#tableSpacing"+l).val()),i=$(d).attr("style"),m=function(w,x,y){if(x){$(d).removeAttr(w)}else{$(d).attr(w,y)}};if($T(i)=="string"&&i!=""){var r=i.split(";"),n="";for(var v=0;v<r.length;v++){if(r[v].toLowerCase().indexOf("width")==-1&&r[v].toLowerCase().indexOf("height")==-1&&r[v].trim()!=""){n+=r[v]+";"}}m("style",(n==""),n)}m("width",(isNaN(u)||u==0),u+f.percent(e));m("height",(isNaN(c)||c==0),c+f.percent(s));m("bgcolor",(t==""),t);m("background",(o==""),o);m("border",(isNaN(j)||j==0),j);m("align",(b==""),b);m("bordercolor",(k==""),k);m("cellpadding",(isNaN(q)),q);m("cellspacing",(isNaN(p)),p);DM.container.close()},editCell:function(){var j=DMEditor,k=j.doTable,d=DM.choose,e=j.rand,m=k.parentElement,a=$(m).attr("width")||"",g=$(m).attr("height")||"",b="pixel",c="pixel",n=$(m).attr("align")||"",f=$(m).attr("valign")||"",i=$(m).attr("background")||"",l=$(m).attr("bgcolor")||"",o="";k.menus.mode=3;if(a.indexOf("%")>=0){a=a.substr(0,a.length-1);b="percent"}if(g.indexOf("%")>=0){g=g.substr(0,g.length-1);c="percent"}o='<table width="100%" cellspacing="2" cellpadding="2"><tr><td class="DMTitle"><nobr>عرض الخلية</nobr></td><td class="DMText"><input type="text" class="DMInput" id="tdWidth'+e+'" style="width:30px;text-align:center;" value="'+a+'" dir="ltr"><select class="DMSelect" id="tdWidthType'+e+'"><option value="pixel">نقطة</option><option value="percent"'+d("percent",b)+'>نسبة مئوية</option></select></td><td class="DMTitle"><nobr>ارتفاع الخلية</nobr></td><td class="DMText"><input type="text" class="DMInput" id="tdHeight'+e+'" style="width:30px;text-align:center;" value="'+g+'" dir="ltr"><select class="DMSelect" id="tdHeightType'+e+'"><option value="pixel">نقطة</option><option value="percent"'+d("percent",c)+'>نسبة مئوية</option></select></td></tr><tr><td class="DMTitle"><nobr>تنسيق افقي للخلية</nobr></td><td class="DMText"><select class="DMSelect" id="tdAlign'+e+'"><option value=""></option><option value="left"'+d("left",n)+'>يسار</option><option value="center"'+d("center",n)+'>وسط</option><option value="right"'+d("right",n)+'>يمين</option></select></td><td class="DMTitle"><nobr>تنسيق عمودي للخلية</nobr></td><td class="DMText"><select class="DMSelect" id="tdVAlign'+e+'"><option value=""></option><option value="top"'+d("top",f)+'>أعلى</option><option value="middle"'+d("middle",f)+'>وسط</option><option value="bottom"'+d("bottom",f)+'>أسفل</option></select></td></tr><tr><td class="DMTitle"><nobr>عنوان صورة الخلفية للخلية</nobr></td><td class="DMText" colspan="3"><input type="text" class="DMInput" id="tdBGImage'+e+'" style="width:300px;" value="'+i+'" dir="ltr"></td></tr><tr><td class="DMTitle"><nobr>لون الخلفية للخلية</nobr></td><td class="DMText" colspan="3">'+DM.colorPicker.panel("tdBackground",{blank:true,color:l})+'</td></tr><tr><td class="DMTitle"><nobr>أدخل سطر جديد</nobr></td><td class="DMText" colspan="3"><nobr><input type="button" class="DMButton" onclick="DMEditor.doTable.doCell(\'insertRowAbove\');" value="فوق">&nbsp;&nbsp;<input type="button" class="DMButton" onclick="DMEditor.doTable.doCell(\'insertRowBelow\');" value="تحت"></nobr></td></tr><tr><td class="DMTitle"><nobr>أدخل عمود جديد</nobr></td><td class="DMText" colspan="3"><nobr><input type="button" class="DMButton" onclick="DMEditor.doTable.doCell(\'insertColLeft\');" value="الى اليسار">&nbsp;&nbsp;<input type="button" class="DMButton" onclick="DMEditor.doTable.doCell(\'insertColRight\');" value="الى اليمين"></nobr></td></tr><tr><td class="DMTitle"><nobr>أحذف</nobr></td><td class="DMText" colspan="3"><nobr><input type="button" class="DMButton" onclick="DMEditor.doTable.doCell(\'deleteRow\');" value="سطر كامل">&nbsp;&nbsp;<input type="button" class="DMButton" onclick="DMEditor.doTable.doCell(\'deleteCol\');" value="عمود كامل">&nbsp;&nbsp;<input type="button" class="DMButton" onclick="DMEditor.doTable.doCell(\'deleteCell\');" value="الخلية الحالية"></nobr></td></tr><tr><td class="DMTitle"><nobr>تمديد الخلايا</nobr></td><td class="DMText" colspan="3"><nobr><input type="text" class="DMInput" id="tdSpan'+e+'" style="width:30px;text-align:center;" value="2" dir="ltr">&nbsp;&nbsp;<input type="button" class="DMButton" onclick="DMEditor.doTable.doCell(\'colSpan\');" value="تمديد أفقي">&nbsp;&nbsp;<input type="button" class="DMButton" onclick="DMEditor.doTable.doCell(\'rowSpan\');" value="تمديد عمودي"></nobr></td></tr></table>';$(k.body).html(o);k.checkMenusDesign()},doEditCell:function(){var a=DMEditor,f=a.doTable,l=a.rand,j=f.parentElement,g=parseInt($("#tdWidth"+l).val()),d=parseInt($("#tdHeight"+l).val()),e=$("#tdWidthType"+l).val(),p=$("#tdHeightType"+l).val(),b=$("#tdAlign"+l).val(),r=$("#tdVAlign"+l).val(),n=$("#tdBGImage"+l).val(),q=DM.colorPicker.getColor("tdBackground"),i=$(j).attr("style"),k=function(s,t,u){if(t){$(j).removeAttr(s)}else{$(j).attr(s,u)}};if($T(i)=="string"&&i!=""){var o=i.split(";"),m="";for(var c=0;c<o.length;c++){if(o[c].toLowerCase().indexOf("width")==-1&&o[c].toLowerCase().indexOf("height")==-1&&o[c].trim()!=""){m+=o[c]+";"}}k("style",(m==""),m)}k("width",(isNaN(g)||g==0),g+f.percent(e));k("height",(isNaN(d)||d==0),d+f.percent(p));k("align",(b==""),b);k("valign",(r==""),r);k("background",(n==""),n);k("bgcolor",(q==""),q);DM.container.close()},doCell:function(e){if($T(e)!="string"){return}var j=DMEditor,k=j.doTable,g=j.rand,n=k.parentElement,m=$(k.parentElement).parents("tr").get(0),a=$(k.parentElement).parents("table").get(0),b=parseInt($("#tdSpan"+g).val()),c=j.setting.dir,i;if(isNaN(b)){b=2}if(e=="insertRowAbove"){var l=a.insertRow(m.rowIndex);for(var d=0;d<m.cells.length;d++){i=l.insertCell(d);$(i).html("&nbsp;")}}else{if(e=="insertRowBelow"){var l=a.insertRow(m.rowIndex+1);for(var d=0;d<m.cells.length;d++){i=l.insertCell(d);$(i).html("&nbsp;")}}else{if(e=="insertColLeft"){for(var d=0;d<a.rows.length;d++){i=a.rows[d].insertCell(c=="rtl"?n.cellIndex+1:n.cellIndex);$(i).html("&nbsp;")}}else{if(e=="insertColRight"){for(var d=0;d<a.rows.length;d++){i=a.rows[d].insertCell(c=="rtl"?n.cellIndex:n.cellIndex+1);$(i).html("&nbsp;")}}else{if(e=="deleteRow"){a.deleteRow(m.rowIndex)}else{if(e=="deleteCol"){var f=n.cellIndex;for(var d=0;d<a.rows.length;d++){a.rows[d].deleteCell(f)}}else{if(e=="deleteCell"){m.deleteCell(n.cellIndex)}else{if(e=="colSpan"){$(n).attr("colspan",b)}else{if(e=="rowSpan"){$(n).attr("rowspan",b)}}}}}}}}}DM.container.close()},percent:function(a){return($T(a)=="string"&&a=="percent")?"%":""}}};var DMEditor=$.DM.editor;